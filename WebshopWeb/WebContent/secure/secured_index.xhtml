<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    template="secured_template.xhtml">

    <ui:define name="content">
        <div id="logout">
        <h2>Logout</h2>
            <h:form>
                <h:commandLink actionListener="#{userSession.logout}" value="Logout">
                    <!-- <f:ajax execute="@this" render="content_form" onevent="showLoading" /> -->
                </h:commandLink>
            </h:form>
        </div>
        <div id="products">
            <h2>Avaliable Products</h2>
            <h:form id="productlist">
                <ui:repeat value="#{itemMBean.items}" var="item">
                    <p><h:outputText value="#{item.name}"/><br></br>
                       <h:outputText value="#{item.description}"/><br></br>
                       <h:outputText value="#{item.mediapath}"/><br></br>
                       <h:outputText value="#{item.unitprice}"/><br></br>
                       <h:commandButton
                            type="submit"
                            value="Add to Basket"
                            styleClass="btn btn-sm btn-default"
                            action="#{basketBean.addItem(item)}">
                        </h:commandButton>
                    </p>
                </ui:repeat>
            </h:form>
        </div>
        <div id ="basket">
            <h2>Shopping Basket</h2>
            <h:form id="basketproducts">
                <ui:repeat value="#{basketBean.allItems}" var="item">
                    <p><h:outputText value="#{item.name}"/><br></br>
                       <h:outputText value="#{item.description}"/><br></br>
                       <h:outputText value="#{item.mediapath}"/><br></br>
                       <h:outputText value="#{item.unitprice}"/><br></br>
                       <h:commandButton
                            type="submit"
                            value="Remove"
                            styleClass="btn btn-sm btn-default"
                            action="#{basketBean.removeItem(item)}">
                        </h:commandButton>
                    </p>
                </ui:repeat>
            </h:form>
            <h3>Purchase</h3>
            <h:form id="purchase">
                <h:commandButton
                            type="submit"
                            value="Purchase"
                            styleClass="btn btn-sm btn-default"
                            action="#{basketBean.purchase}">
                </h:commandButton>
            </h:form>
        </div>   
    </ui:define>
</ui:composition>